{"ast":null,"code":"var _jsxFileName = \"/home/guilherme/Trybe/Projetos-trybe/sd-07-project-recipes-app/src/pages/FoodDetails.js\";\nimport React, { useState, useContext, useEffect } from 'react';\nimport { Link, useHistory } from 'react-router-dom';\nimport copy from 'clipboard-copy';\nimport shareIcon from \"../images/shareIcon.svg\";\nimport whiteHeartIcon from \"../images/whiteHeartIcon.svg\";\nimport blackHeartIcon from \"../images/blackHeartIcon.svg\";\nimport RecipesContext from '../context/RecipesContext';\nimport { fetchAPI, handleIngredients, TWO_THOUSAND, SIX } from '../services/helpers';\nimport '../style/recipeDetail.css';\nimport { Carousel, Button } from 'antd';\n\nfunction FoodDetails() {\n  const [recipeDetailFood, setRecipeDetailFood] = useState({});\n  const [buttonClassName, setButtonClassName] = useState('fixedbutton');\n  const [buttonText] = useState('Iniciar Receita');\n  const [recommendation, setRecommendation] = useState(['']);\n  const [copyText, setCopyText] = useState('');\n  const [favorited, setFavorited] = useState(); // src: https://reactrouter.com/web/api/Hooks\n\n  const history = useHistory();\n  const {\n    pathname\n  } = history.location;\n  const mealRecipeId = pathname.split('/')[2];\n  const {\n    setMealRecipeId,\n    setDrinkRecipeId\n  } = useContext(RecipesContext);\n  useEffect(() => {\n    const getAPI = async () => {\n      const food = await fetchAPI(`https://www.themealdb.com/api/json/v1/1/lookup.php?i=${mealRecipeId}`);\n      const recipeFood = await food.meals;\n      setRecipeDetailFood(recipeFood[0]);\n      setMealRecipeId(mealRecipeId);\n    };\n\n    getAPI();\n  }, [setMealRecipeId, mealRecipeId, setRecipeDetailFood]);\n  useEffect(() => {\n    const fetchRecommendation = async () => {\n      const drinks = await fetchAPI('https://www.thecocktaildb.com/api/json/v1/1/search.php?s=');\n      const drinksData = await drinks.drinks;\n      setRecommendation(drinksData);\n    };\n\n    fetchRecommendation();\n  }, []);\n\n  const handleCopyClick = () => {\n    copy(window.location.href);\n    setCopyText('Link copiado!');\n    setInterval(() => setCopyText(''), TWO_THOUSAND);\n  };\n\n  useEffect(() => {\n    if (!localStorage.favoriteRecipes) localStorage.favoriteRecipes = JSON.stringify([]);\n    const favoriteStorage = JSON.parse(localStorage.favoriteRecipes).filter(recipe => recipe.id === mealRecipeId);\n\n    if (favoriteStorage.length >= 1) {\n      setFavorited(blackHeartIcon);\n    } else {\n      setFavorited(whiteHeartIcon);\n    }\n  }, [mealRecipeId]);\n  useEffect(() => {\n    if (!localStorage.doneRecipes) localStorage.doneRecipes = JSON.stringify([]);\n    const doneStorage = JSON.parse(localStorage.doneRecipes).filter(recipe => recipe.id === mealRecipeId);\n\n    if (doneStorage.length >= 1) {\n      setButtonClassName('fixedbutton hidden');\n    } else {\n      setButtonClassName('fixedbutton');\n    }\n  }, [mealRecipeId]);\n\n  const handleFavoriteClick = () => {\n    if (favorited === whiteHeartIcon) {\n      setFavorited(blackHeartIcon);\n      const favoriteStorage = JSON.parse(localStorage.favoriteRecipes);\n      const newFavoriteStorage = favoriteStorage.concat({\n        id: recipeDetailFood.idMeal,\n        type: 'comida',\n        area: recipeDetailFood.strArea,\n        category: recipeDetailFood.strCategory,\n        alcoholicOrNot: '',\n        name: recipeDetailFood.strMeal,\n        image: recipeDetailFood.strMealThumb\n      });\n      localStorage.favoriteRecipes = JSON.stringify(newFavoriteStorage);\n    } else {\n      setFavorited(whiteHeartIcon);\n      const favoriteStorage = JSON.parse(localStorage.favoriteRecipes);\n      const newFavoriteStorage = favoriteStorage.filter(recipe => recipe.id !== mealRecipeId);\n      localStorage.favoriteRecipes = JSON.stringify(newFavoriteStorage);\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    className: \"img-recipe\",\n    \"data-testid\": \"recipe-photo\",\n    src: recipeDetailFood.strMealThumb,\n    alt: \"food\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"h2\", {\n    \"data-testid\": \"recipe-title\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 7\n    }\n  }, recipeDetailFood.strMeal), /*#__PURE__*/React.createElement(\"button\", {\n    type: \"button\",\n    onClick: handleCopyClick,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    \"data-testid\": \"share-btn\",\n    src: shareIcon,\n    alt: \"share\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 9\n    }\n  })), /*#__PURE__*/React.createElement(\"button\", {\n    type: \"button\",\n    onClick: handleFavoriteClick,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    \"data-testid\": \"favorite-btn\",\n    src: favorited,\n    alt: \"favorite\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 9\n    }\n  })), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 7\n    }\n  }, copyText), /*#__PURE__*/React.createElement(\"p\", {\n    \"data-testid\": \"recipe-category\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 7\n    }\n  }, recipeDetailFood.strCategory), /*#__PURE__*/React.createElement(\"ul\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 7\n    }\n  }, handleIngredients(recipeDetailFood)), /*#__PURE__*/React.createElement(\"p\", {\n    \"data-testid\": \"instructions\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 7\n    }\n  }, recipeDetailFood.strInstructions), /*#__PURE__*/React.createElement(\"video\", {\n    className: \"video\",\n    \"data-testid\": \"video\",\n    width: \"750\",\n    height: \"500\",\n    controls: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"source\", {\n    src: recipeDetailFood.strYoutube,\n    type: \"video/mp4\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"track\", {\n    src: recipeDetailFood.strYoutube,\n    kind: \"captions\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 9\n    }\n  })), /*#__PURE__*/React.createElement(Carousel, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 7\n    }\n  }, recommendation && recommendation.length && recommendation.filter((_, indexFilter) => indexFilter < SIX).map((drinks, index) => /*#__PURE__*/React.createElement(\"div\", {\n    \"data-testid\": `${index}-recomendation-card`,\n    key: index,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(Link, {\n    onClick: () => setDrinkRecipeId(drinks.idDrink),\n    to: `/bebidas/${drinks.idDrink}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    className: \"img-recipe\",\n    \"data-testid\": `${index}-card-img`,\n    width: \"300\",\n    src: drinks.strDrinkThumb,\n    alt: drinks.strDrink,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 19\n    }\n  })), /*#__PURE__*/React.createElement(\"p\", {\n    \"data-testid\": `${index}-recomendation-title`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 17\n    }\n  }, drinks.strDrink)))), /*#__PURE__*/React.createElement(Link, {\n    to: `/comidas/${mealRecipeId}/in-progress`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    className: buttonClassName,\n    type: \"primary\",\n    \"data-testid\": \"start-recipe-btn\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 9\n    }\n  }, buttonText)));\n}\n\nexport default FoodDetails;","map":{"version":3,"sources":["/home/guilherme/Trybe/Projetos-trybe/sd-07-project-recipes-app/src/pages/FoodDetails.js"],"names":["React","useState","useContext","useEffect","Link","useHistory","copy","RecipesContext","fetchAPI","handleIngredients","TWO_THOUSAND","SIX","Carousel","Button","FoodDetails","recipeDetailFood","setRecipeDetailFood","buttonClassName","setButtonClassName","buttonText","recommendation","setRecommendation","copyText","setCopyText","favorited","setFavorited","history","pathname","location","mealRecipeId","split","setMealRecipeId","setDrinkRecipeId","getAPI","food","recipeFood","meals","fetchRecommendation","drinks","drinksData","handleCopyClick","window","href","setInterval","localStorage","favoriteRecipes","JSON","stringify","favoriteStorage","parse","filter","recipe","id","length","blackHeartIcon","whiteHeartIcon","doneRecipes","doneStorage","handleFavoriteClick","newFavoriteStorage","concat","idMeal","type","area","strArea","category","strCategory","alcoholicOrNot","name","strMeal","image","strMealThumb","shareIcon","strInstructions","strYoutube","_","indexFilter","map","index","idDrink","strDrinkThumb","strDrink"],"mappings":"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","sourcesContent":["import React, { useState, useContext, useEffect } from 'react';\nimport { Link, useHistory } from 'react-router-dom';\nimport copy from 'clipboard-copy';\nimport shareIcon from '../images/shareIcon.svg';\nimport whiteHeartIcon from '../images/whiteHeartIcon.svg';\nimport blackHeartIcon from '../images/blackHeartIcon.svg';\nimport RecipesContext from '../context/RecipesContext';\nimport {\n  fetchAPI, handleIngredients,\n  TWO_THOUSAND, SIX\n} from '../services/helpers';\nimport '../style/recipeDetail.css';\nimport { Carousel , Button } from 'antd';\n\nfunction FoodDetails() {\n  const [recipeDetailFood, setRecipeDetailFood] = useState({});\n  const [buttonClassName, setButtonClassName] = useState('fixedbutton');\n  const [buttonText] = useState('Iniciar Receita');\n  const [recommendation, setRecommendation] = useState(['']);\n  const [copyText, setCopyText] = useState('');\n  const [favorited, setFavorited] = useState();\n  // src: https://reactrouter.com/web/api/Hooks\n  const history = useHistory();\n  const { pathname } = history.location;\n  const mealRecipeId = pathname.split('/')[2];\n\n  const {\n    setMealRecipeId,\n    setDrinkRecipeId,\n  } = useContext(RecipesContext);\n\n  useEffect(() => {\n    const getAPI = async () => {\n      const food = await fetchAPI(`https://www.themealdb.com/api/json/v1/1/lookup.php?i=${mealRecipeId}`);\n      const recipeFood = await food.meals;\n      setRecipeDetailFood(recipeFood[0]);\n      setMealRecipeId(mealRecipeId);\n    };\n    getAPI();\n  }, [setMealRecipeId, mealRecipeId, setRecipeDetailFood]);\n\n  useEffect(() => {\n    const fetchRecommendation = async () => {\n      const drinks = await fetchAPI('https://www.thecocktaildb.com/api/json/v1/1/search.php?s=');\n      const drinksData = await drinks.drinks;\n      setRecommendation(drinksData);\n    };\n    fetchRecommendation();\n  }, []);\n\n  const handleCopyClick = () => {\n    copy(window.location.href);\n    setCopyText('Link copiado!');\n    setInterval(() => setCopyText(''), TWO_THOUSAND);\n  };\n\n  useEffect(() => {\n    if (!localStorage.favoriteRecipes) localStorage.favoriteRecipes = JSON.stringify([]);\n    const favoriteStorage = JSON.parse(localStorage.favoriteRecipes)\n      .filter((recipe) => recipe.id === mealRecipeId);\n    if (favoriteStorage.length >= 1) {\n      setFavorited(blackHeartIcon);\n    } else {\n      setFavorited(whiteHeartIcon);\n    }\n  }, [mealRecipeId]);\n\n  useEffect(() => {\n    if (!localStorage.doneRecipes) localStorage.doneRecipes = JSON.stringify([]);\n    const doneStorage = JSON.parse(localStorage.doneRecipes)\n      .filter((recipe) => recipe.id === mealRecipeId);\n    if (doneStorage.length >= 1) {\n      setButtonClassName('fixedbutton hidden');\n    } else {\n      setButtonClassName('fixedbutton');\n    }\n  }, [mealRecipeId]);\n\n  const handleFavoriteClick = () => {\n    if (favorited === whiteHeartIcon) {\n      setFavorited(blackHeartIcon);\n      const favoriteStorage = JSON.parse(localStorage.favoriteRecipes);\n      const newFavoriteStorage = favoriteStorage.concat({\n        id: recipeDetailFood.idMeal,\n        type: 'comida',\n        area: recipeDetailFood.strArea,\n        category: recipeDetailFood.strCategory,\n        alcoholicOrNot: '',\n        name: recipeDetailFood.strMeal,\n        image: recipeDetailFood.strMealThumb,\n      });\n      localStorage.favoriteRecipes = JSON.stringify(newFavoriteStorage);\n    } else {\n      setFavorited(whiteHeartIcon);\n      const favoriteStorage = JSON.parse(localStorage.favoriteRecipes);\n      const newFavoriteStorage = favoriteStorage\n        .filter((recipe) => recipe.id !== mealRecipeId);\n      localStorage.favoriteRecipes = JSON.stringify(newFavoriteStorage);\n    }\n  };\n\n  return (\n    <div>\n      <img className=\"img-recipe\" data-testid=\"recipe-photo\" src={recipeDetailFood.strMealThumb} alt=\"food\" />\n      <h2 data-testid=\"recipe-title\">{recipeDetailFood.strMeal}</h2>\n      <button type=\"button\" onClick={handleCopyClick}>\n        <img data-testid=\"share-btn\" src={shareIcon} alt=\"share\" />\n      </button>\n      <button type=\"button\" onClick={handleFavoriteClick}>\n        <img data-testid=\"favorite-btn\" src={favorited} alt=\"favorite\" />\n      </button>\n      <p>{copyText}</p>\n      <p data-testid=\"recipe-category\">{recipeDetailFood.strCategory}</p>\n      <ul>\n        {handleIngredients(recipeDetailFood)}\n      </ul>\n      <p data-testid=\"instructions\">{recipeDetailFood.strInstructions}</p>\n      <video className=\"video\" data-testid=\"video\" width=\"750\" height=\"500\" controls>\n        <source src={recipeDetailFood.strYoutube} type=\"video/mp4\" />\n        <track src={recipeDetailFood.strYoutube} kind=\"captions\" />\n      </video>\n      <Carousel>\n        {\n          recommendation && recommendation.length && recommendation\n            .filter((_, indexFilter) => indexFilter < SIX)\n            .map((drinks, index) => (\n              <div\n                data-testid={`${index}-recomendation-card`}\n                key={index}\n              >\n                <Link\n                  onClick={() => setDrinkRecipeId(drinks.idDrink)}\n                  to={`/bebidas/${drinks.idDrink}`}\n                >\n                  <img\n                    className=\"img-recipe\"\n                    data-testid={`${index}-card-img`}\n                    width=\"300\"\n                    src={drinks.strDrinkThumb}\n                    alt={drinks.strDrink}\n                  />\n                </Link>\n                <p\n                  data-testid={`${index}-recomendation-title`}\n                >\n                  {drinks.strDrink}\n                </p>\n              </div>\n            ))\n        }\n      </Carousel>\n      <Link to={`/comidas/${mealRecipeId}/in-progress`}>\n        <Button\n          className={buttonClassName}\n          type=\"primary\"\n          data-testid=\"start-recipe-btn\"\n        >\n          {buttonText}\n        </Button>\n      </Link>\n    </div>\n  );\n}\n\nexport default FoodDetails;\n"]},"metadata":{},"sourceType":"module"}